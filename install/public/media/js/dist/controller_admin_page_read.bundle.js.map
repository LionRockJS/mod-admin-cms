{"version":3,"file":"controller_admin_page_read.bundle.js","mappings":"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","sources":["webpack:///../../../../../../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///../../../../../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///../../../../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../../../../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../../../../../../node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///../../../../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./classes/pagefield/Page.mjs","webpack:///./classes/helper/Page.mjs","webpack:///./classes/MediaPort.js","webpack:///./entry/admin/pages/read.js"],"sourcesContent":["export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","export default class{\n  static isInit = false;\n  static pages = new Map();\n\n  static init(){\n    if(this.isInit)return;\n    this.isInit = true;\n\n    const domRoot = document.querySelector('html');\n    const language = domRoot.getAttribute('lang');\n    const fields = document.querySelectorAll('.pagefield-page');\n\n    fields.forEach(it => {\n      const page_type = it.getAttribute('data-page-type');\n      const trigger = it.querySelector('.pagefield-page-input');\n      const inputValue = it.querySelector('.pagefield-page-value');\n      const badgeContainer = it.querySelector('.pagefield-page-badges');\n      const datalist = this.fetchPageList(page_type, language);\n\n      //search box UI\n      trigger.addEventListener('change', () => {\n        const option = datalist.querySelector(`option[value=\"${trigger.value}\"]`);\n        //reset input\n        trigger.value = '';\n        if(!option)return;\n\n        const pageId = option.getAttribute('data-id');\n        //check if page already added to inputValue\n        if(inputValue.value.split(',').includes(pageId))return;\n\n        //create badge\n        this.addPageBadge(badgeContainer, pageId, inputValue, datalist);\n        this.updatePageInputValue(inputValue, badgeContainer);\n      });\n\n      //parse input value to badges\n      inputValue.value.split(',').forEach(pageId => {\n        if(!pageId)return;\n        this.addPageBadge(badgeContainer, pageId, inputValue, datalist);\n      });\n\n      //make badges sortable\n      new Sortable(badgeContainer, {\n        animation: 150,\n        ghostClass: 'opacity-50',\n        onEnd: () => this.updatePageInputValue(inputValue, badgeContainer),\n      });\n    });\n  }\n\n  //update page input when badges added, removed or sorted\n  static updatePageInputValue(input, pagePanel){\n    const badges = pagePanel.querySelectorAll('.badge');\n    const ids = Array.from(badges).map(it => it.getAttribute('data-page-id'));\n    //remove last -input from trigger.id\n    input.value = ids.join(',');\n  }\n\n  static addPageBadge(pagePanel, page_id, input, datalist){\n    const refPage = document.createElement('span');\n    const text = datalist.querySelector(`option[data-id=\"${page_id}\"]`)?.value || page_id;\n\n    refPage.setAttribute('data-page-id', page_id);\n    refPage.classList.add(\"badge\", \"bg-primary\", \"rounded-pill\");\n    refPage.innerHTML = `${text} <i class=\"fas fa-times\"></i>`;\n    refPage.addEventListener('click', () => {\n      refPage.remove();\n      this.updatePageInputValue(input, pagePanel);\n    })\n\n    //add to result div\n    pagePanel.append(refPage);\n  }\n\n  static sort(a,b){\n    if(a.name < b.name)return -1;\n    if(a.name > b.name)return 1;\n    return 0;\n  }\n\n  static fetchPageList(pageType, language){\n    const id = `page-list-${pageType}`;\n    const existDatalist = document.querySelector(`#${id}`);\n    if(existDatalist)return existDatalist;\n\n    //load page ids to create datalist\n    const datalist = document.createElement('datalist');\n    datalist.id = id;\n    document.body.appendChild(datalist);\n\n    fetch(`/admin/api/pages/${pageType}?language=${language}`).then(res => {\n      res.json().then(pages =>{\n        //sort pages by name\n        datalist.innerHTML = pages.sort(this.sort).map(it => {\n          document.querySelectorAll(`.badge[data-page-id=\"${it.page}\"]`).forEach(badge => {\n            badge.innerHTML = `${it.name} <i class=\"fas fa-times\"></i>`\n          });\n          return `<option value=\"${it.name}\" data-id=\"${it.page}\" />`;\n        }).join('\\n');\n      })\n    });\n    return datalist;\n  }\n}","import PageFieldPage from \"../pagefield/Page.mjs\";\n\nexport default class HelperPage{\n  static enableAutoSave(){\n    const cbAutoSave = document.getElementById('autosave');\n    if(!cbAutoSave)return;\n\n    cbAutoSave.addEventListener('change', evt => {\n      evt.currentTarget.form.submit();\n    })\n  }\n\n  static enablePageInput(){\n    PageFieldPage.init();\n  }\n\n  static enablePointers(){\n    const domRoot = document.querySelector('html');\n    const language = domRoot.getAttribute('lang');\n    const refPages = document.querySelectorAll('select.ref-pages');\n    refPages.forEach(it => {\n      const pageType = it.getAttribute('data-pagetype');\n\n      fetch(`/admin/api/pages/${pageType}?language=${language}`).then(res => {\n        res.json().then(obj =>{\n          console.log(obj);\n        })\n      })\n      console.log(it);\n    });\n\n    const refPageItems = document.querySelectorAll('select.ref-page-items');\n    refPageItems.forEach(it => {\n      const sourceOptions = it.innerHTML;\n      const value = it.getAttribute('data-value');\n      const pageType = it.getAttribute('data-pagetype');\n      const itemName = it.getAttribute('data-item');\n      const url = `/admin/api/page-items/${pageType}/${itemName}?language=${language}`;\n      it.innerHTML = `<option value=\"\">Loading...</option>`;\n      fetch(url).then(res =>{\n        res.json().then(pages =>{\n          const options = [sourceOptions];\n          pages.forEach(page => {\n            options.push(`<optgroup label=\"${page.name}\">`)\n            page.items.forEach(item => {\n              options.push(`<option value=\"${item.id}\" ${(item.id.toString() === value) ? 'selected' : '' }>${item.name}</option>`);\n            })\n            options.push(`</optgroup>`);\n          })\n          it.innerHTML = options.join('/n');\n        });\n      });\n    });\n  }\n\n  static enableBlock(){\n    const elAddBlock = document.getElementById('add-block');\n    if(elAddBlock){\n      const blockSelect = elAddBlock.querySelector('select');\n      const blockBtn = elAddBlock.querySelector('a');\n\n      blockSelect.addEventListener('change', () =>{\n        blockBtn.setAttribute('href', blockBtn.getAttribute('data-link').replace('[block_name]', blockSelect.value))\n      })\n    }\n  }\n\n  static addPageTag(pageId, tagId, cb){\n    fetch(`/admin/api/page/${pageId}/tag/${tagId}`, {\n      credentials: 'include',\n      method: \"POST\",\n    }).then(res => res.json().then(fsa => {\n      console.log(fsa);\n      if(fsa.payload.success !== true)return;\n      cb(fsa.payload);\n    }))\n  }\n\n  static enablePageTag(){\n    document.querySelectorAll('.page-tag-form').forEach(el => {\n      const pageId = el.getAttribute('data-page');\n      const inputField = el.querySelector('.tag-add-input');\n      const pageTagList = el.querySelector('.page-tag-list');\n\n      const removePageTag = evt => {\n        const element = evt.currentTarget;\n\n        fetch(`/admin/api/page_tag/${element.getAttribute('data-id')}`, {\n          credentials: 'include',\n          method: \"DELETE\",\n        }).then(res => res.json().then(obj => {\n          console.log(obj);\n          element.remove();\n        }))\n      }\n\n      el.querySelector('.toggle-input-tag').addEventListener('click', element => {\n        if(inputField.classList.contains('visually-hidden')){\n          inputField.classList.remove('visually-hidden');\n        }else{\n          inputField.classList.add('visually-hidden');\n        }\n      })\n\n      el.querySelectorAll('.page-tag.badge').forEach(tagElement => {\n        tagElement.addEventListener('click', removePageTag);\n      })\n\n      inputField.addEventListener('change', () => {\n        const option = el.querySelector(`option[value=\"${inputField.value}\"]`);\n        if(!option)return;\n        const tag_id = option.getAttribute('data-id');\n        const tag_value = option.getAttribute('data-value');\n        const tag_name = option.getAttribute('data-name');\n\n        this.addPageTag(pageId, tag_id, (payload) => {\n          const newTag = document.createElement('span');\n          newTag.value = `${tag_value} ( ${tag_name} )`;\n          newTag.setAttribute('data-id', payload.id);\n          newTag.setAttribute('role', \"button\");\n          newTag.classList.add(\"badge\", \"bg-primary\", \"rounded-pill\");\n          newTag.innerHTML = `${tag_value} <i class=\"fas fa-times\"></i>`;\n          pageTagList.appendChild(newTag);\n          pageTagList.appendChild(document.createTextNode(' '));\n          inputField.value = '';\n          newTag.addEventListener('click', removePageTag);\n        })\n      });\n    })\n  }\n}","export default class MediaPort{\n  static enableUpload(uploadURL, options = {}){\n    const opt = {\n      apiKey: 'api',\n      dir: 'cms',\n      selector: '.page-field-upload',\n      selectorFile : 'input[type=\"file\"]',\n      callback      : (error, element, result) => {\n        if(error)throw error;\n        const uploadedFile = result.files[0];\n        const txtInput = element.querySelector('.page-field-upload-text');\n        const preview = element.querySelector('.preview img')\n        txtInput.value = `/${uploadedFile}`;\n        if(preview)preview.src = `${options.previewUrl||'https://www.example.com'}${uploadedFile}`;\n      },\n      ...options\n    }\n\n    const uploadFields = document.querySelectorAll(opt.selector);\n\n    uploadFields.forEach(el => {\n      const fileInput = el.querySelector(opt.selectorFile);\n      fileInput.addEventListener('change', () => {\n        const formData = new FormData();\n        formData.append('file', fileInput.files[0]);\n        formData.append('dir', opt.dir);\n        formData.append('api-key', opt.apiKey);\n\n        fetch(uploadURL, { // Your POST endpoint\n          method: 'POST',\n          body: formData,\n          mode: 'cors', // no-cors, cors, *same-origin\n        }).then(\n          response => {\n            response.json().then(obj => {\n              const uploadedFile = obj.files[0];\n              if(!uploadedFile)return opt.callback(new Error('upload error'), el, uploadedFile);\n              opt.callback(null, el, obj);\n            });\n          }\n        ).catch(\n          error => opt.callback(error, el, null)\n        );\n      }, false);\n    })\n  }\n}","import HelperPage from \"../../../classes/helper/Page.mjs\";\nimport MediaPort from \"../../../classes/MediaPort\";\n\nHelperPage.enableAutoSave();\n//HelperPage.enablePointers();\n//HelperPage.enableBlock();\nHelperPage.enablePageTag();\nHelperPage.enablePageInput();\n\nconst apiKey = {\n  'admin.example.com' : 'api-name',\n}\n\nconst uploadURL = {\n  'admin.example.com' : 'https://mediaport.dappod.com/upload',\n}\n\nMediaPort.enableUpload(uploadURL[window.location.hostname] || '/admin/upload', {\n  apiKey : apiKey[window.location.hostname] || 'default',\n  dir : 'cms',\n  previewUrl : window.location.origin + '/'\n});\n\ntinymce.init({\n  selector: 'textarea',\n  menubar: '',\n  branding: false,\n  width: '100%',\n  plugins: 'code',\n  toolbar: 'undo redo bold italic removeformat code',\n  paste_as_text: true\n}).then();"],"names":["_classCallCheck","instance","Constructor","TypeError","_typeof","obj","Symbol","iterator","constructor","prototype","_toPropertyKey","arg","key","input","hint","prim","toPrimitive","undefined","res","call","String","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","protoProps","staticProps","_defineProperty","value","_this","this","isInit","language","document","querySelector","getAttribute","querySelectorAll","forEach","it","page_type","trigger","inputValue","badgeContainer","datalist","fetchPageList","addEventListener","option","concat","pageId","split","includes","addPageBadge","updatePageInputValue","Sortable","animation","ghostClass","onEnd","pagePanel","badges","ids","Array","from","map","join","page_id","_datalist$querySelect","_this2","refPage","createElement","text","setAttribute","classList","add","innerHTML","remove","append","a","b","name","pageType","_this3","id","existDatalist","body","appendChild","fetch","then","json","pages","sort","page","badge","_default","Map","HelperPage","cbAutoSave","getElementById","evt","currentTarget","form","submit","PageFieldPage","console","log","sourceOptions","itemName","url","options","push","items","item","toString","elAddBlock","blockSelect","blockBtn","replace","tagId","cb","credentials","method","fsa","payload","success","el","inputField","pageTagList","removePageTag","element","contains","tagElement","tag_id","tag_value","tag_name","addPageTag","newTag","createTextNode","MediaPort","uploadURL","arguments","opt","_objectSpread","apiKey","dir","selector","selectorFile","callback","error","result","uploadedFile","files","txtInput","preview","src","previewUrl","fileInput","formData","FormData","mode","response","Error","enableAutoSave","enablePageTag","enablePageInput","enableUpload","window","location","hostname","origin","tinymce","init","menubar","branding","width","plugins","toolbar","paste_as_text"],"sourceRoot":""}